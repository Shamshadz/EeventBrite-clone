{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="row row-cols-1 row-cols-md-3 g-4">
  {% for i in events %}
  <div class="col">
    <div class="card h-100">
      <img src="{{ i.image.url }}" class="card-img-top" alt="...">
      <div class="card-body">
        <h5 class="card-title">{{ i.event_name }}</h5>
        <p class="card-text">{{ i.time }}</p>
        <p class="card-text">{{ i.date }}</p>
        <p class="card-text">{{ i.location }}</p>

        <button class="likeBtn" data-id="{{ i.id }}" id="{{ i.id }}">
          <i class="fa-solid fa-heart"></i>
        </button>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script>

  $(function () {
    $('.likeBtn').on('click', function () {
      //Fetch Id 
      var id = $(this).data('id');
      console.log("lol")

      $.ajax({
        type: "POST",
        url: '/likes',

        data: {
          csrfmiddlewaretoken: '{{ csrf_token }}',
          id: id
        },   /* Passing the text data */
        success: function (response) {
          alert('Added to likes section ):');
          console.log(response);
          if(response.liked==true){
          $('#'+ id +' i').css("color","red");
          }
          else if(response.liked==false){
          $('#'+ id +' i').css("color","black");
          }
        }
      });
    });
  }); 
</script>

{% endblock %}